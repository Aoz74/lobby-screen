<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lobby Display - Amahot 11</title>

<style>
:root {
  --accent:#2563eb;
  --danger:#dc2626;
  --text:#f8fafc;
  --panel:rgba(30,41,59,.75);
}

html,body{
  margin:0;height:100%;width:100%;
  background:#020617;color:var(--text);
  font-family:'Segoe UI',system-ui;
  overflow:hidden;
}

.dashboard{
  display:grid;
  grid-template-columns:350px 1fr 350px;
  grid-template-rows:100px 1fr 60px;
  gap:15px;
  padding:15px;
  height:100%;
  box-sizing:border-box;
}

header{
  grid-column:1/-1;
  background:var(--panel);
  border-radius:15px;
  padding:0 30px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}

.clock-area{
  display:flex;
  gap:20px;
  align-items:center;
  text-align:right;
}

.time{font-size:2.5rem;font-weight:800}
.date{font-size:1.1rem;color:#94a3b8}
.weather{font-size:1.5rem;color:#fbbf24;font-weight:bold}

.sidebar{
  background:var(--panel);
  border-radius:15px;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.sidebar-title{
  background:var(--accent);
  padding:12px;
  text-align:center;
  font-size:1.2rem;
  font-weight:bold;
}

.feed-container{
  flex:1;
  overflow:hidden;
  position:relative;
}

.scroll-v{
  padding:15px;
  animation:scrollUp 50s linear infinite;
}

@keyframes scrollUp{
  from{transform:translateY(0)}
  to{transform:translateY(-50%)}
}

.news-item{
  margin-bottom:18px;
  border-bottom:1px solid rgba(255,255,255,.1);
  padding-bottom:8px;
}

.main-stage{
  position:relative;
  border-radius:15px;
  overflow:hidden;
  background-size:cover;
  background-position:center;
  display:flex;
  align-items:flex-end;
}

.overlay-text{
  width:100%;
  padding:40px;
  background:linear-gradient(transparent,rgba(0,0,0,.9));
}

.middle-roller{
  position:absolute;
  bottom:30px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.65);
  padding:10px 30px;
  border-radius:20px;
  font-size:1.4rem;
  opacity:0;
  transition:.6s ease;
}
.middle-roller.show{
  opacity:1;
  transform:translate(-50%,-20px);
}

.footer-ticker{
  grid-column:1/-1;
  background:var(--danger);
  border-radius:10px;
  display:flex;
  align-items:center;
  overflow:hidden;
}

.ticker-label{
  background:#991b1b;
  padding:0 20px;
  font-weight:bold;
  height:100%;
  display:flex;
  align-items:center;
}

.marquee-h{
  white-space:nowrap;
  font-size:1.5rem;
  padding-right:20px;
  animation:scrollRTL 220s linear infinite;
}

@keyframes scrollRTL{
  from{transform:translateX(-100%)}
  to{transform:translateX(0)}
}
</style>
</head>

<body>

<div class="dashboard">

<header>
  <h1 id="display-title">×˜×•×¢×Ÿ...</h1>
  <div id="parasha" style="color:#fbbf24;font-size:1.4rem;font-weight:bold"></div>
  <div class="clock-area">
    <div id="weather-info" class="weather">--</div>
    <div>
      <div class="time" id="clock-t"></div>
      <div class="date" id="clock-d"></div>
    </div>
  </div>
</header>

<div class="sidebar">
  <div class="sidebar-title">ğŸ“¢ ×”×•×“×¢×•×ª ×•×¢×“ ×”×‘×™×ª</div>
  <div class="feed-container">
    <div class="scroll-v" id="comm-list"></div>
  </div>
</div>

<div class="main-stage" id="display-bg">
  <div class="overlay-text">
    <h2 style="font-size:3rem;margin:0">×××”×•×ª 11 - ××™×›×•×ª ×—×™×™×</h2>
  </div>
  <div id="middle-roller" class="middle-roller"></div>
</div>

<div class="sidebar">
  <div class="sidebar-title" id="right-title"></div>
  <div class="feed-container">
    <div class="scroll-v" id="right-content"></div>
  </div>
</div>

<div class="footer-ticker">
  <div class="ticker-label">â„¹ï¸</div>
  <div class="marquee-h" id="footer-text"></div>
</div>

</div>

<script>
const config={
  title:"×××”×•×ª 11 - ×‘×¨×•×›×™× ×”×‘××™×",
  bg:"https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=1600",
  comm:[
    "×©×“×¨×•×’ ×”××¢×œ×™×•×ª ×™×—×œ ×‘×§×¨×•×‘ ×××•×“",
    "× × ×œ×©××•×¨ ×¢×œ × ×™×§×™×•×Ÿ ×”×œ×•×‘×™",
    "×ª×•×“×” ×¢×œ ×©×™×ª×•×£ ×”×¤×¢×•×œ×”"
  ],
  wallaUrl:"https://rss.view.nuvola.co.il/api/Rss/walla",
  maarivUrl:"https://rss.view.nuvola.co.il/api/Rss/maariv"
};

const rollerMessages=[
  "× × ×œ×©××•×¨ ×¢×œ ×”×©×§×˜ ×‘×œ×•×‘×™",
  "×‘×™×—×“ ×©×•××¨×™× ×¢×œ ××™×›×•×ª ×—×™×™×",
  "×ª×•×“×” ×¢×œ ×”×”×ª×—×©×‘×•×ª ×‘×©×›× ×™×"
];

function shorten(t,max=40){
  return t.length>max?t.slice(0,max)+"â€¦":t;
}

function weatherIcon(c){
  if(c===0)return"â˜€ï¸";
  if([1,2].includes(c))return"ğŸŒ¤ï¸";
  if(c===3)return"â˜ï¸";
  if([51,53,55,61,63,65].includes(c))return"ğŸŒ§ï¸";
  if([95,96,99].includes(c))return"â›ˆï¸";
  return"ğŸŒ¡ï¸";
}

async function fetchWeather(){
  const r=await fetch("https://api.open-meteo.com/v1/forecast?latitude=31.93&longitude=34.80&current_weather=true");
  const d=await r.json();
  document.getElementById("weather-info").innerText=
    weatherIcon(d.current_weather.weathercode)+" "+Math.round(d.current_weather.temperature)+"Â°C";
}

async function fetchRSS(url,elId,horizontal){
  const el=document.getElementById(elId);
  const xml=new DOMParser().parseFromString(await (await fetch(url)).text(),"text/xml");
  let items=xml.querySelectorAll("item,entry");
  if(!items.length) items=xml.getElementsByTagName("title");
  let txt="",html="";
  [...items].forEach(i=>{
    const t=i.textContent?.trim();
    if(!t||t.length<10)return;
    txt+=t+" â€¢ ";
    html+=`<div class="news-item"><strong>${t}</strong></div>`;
  });
  horizontal?el.innerText=txt+txt:el.innerHTML=html;
}

function getParasha(){
  return "×¤×¨×©×ª ×”×©×‘×•×¢: ×™×ª×¨×•";
}

function update(){
  document.getElementById("display-title").innerText=config.title;
  document.getElementById("display-bg").style.backgroundImage=`url('${config.bg}')`;
  document.getElementById("comm-list").innerHTML=
    config.comm.map(t=>`<div class="news-item">${shorten(t)}</div>`).join("");

  const d=new Date().getDay();
  if(d===5){
    document.getElementById("right-title").innerText="ğŸ“– ×¤×¨×©×ª ×”×©×‘×•×¢";
    document.getElementById("right-content").innerHTML=`<div class="news-item">${getParasha()}</div>`;
    document.getElementById("footer-text").innerText=getParasha()+" â€¢ "+getParasha();
  }else{
    document.getElementById("right-title").innerText="ğŸŒ ××‘×–×§×™ ×•×•××œ×”!";
    fetchRSS(config.wallaUrl,"right-content");
    document.getElementById("footer-text").innerText="×××—×œ×™× ×œ×›× ×™×•× × ×¢×™× ×•×©×§×˜ ×‘×‘× ×™×™×Ÿ ğŸ¡ â€¢ ";
  }

  fetchRSS(config.maarivUrl,"footer-text",true);
  fetchWeather();
}

let ri=0;
setInterval(()=>{
  const el=document.getElementById("middle-roller");
  el.classList.remove("show");
  setTimeout(()=>{
    el.innerText=rollerMessages[ri];
    el.classList.add("show");
    ri=(ri+1)%rollerMessages.length;
  },500);
},3000);

setInterval(()=>{
  const n=new Date();
  clock-t.innerText=n.toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"});
  clock-d.innerText=n.toLocaleDateString("he-IL",{weekday:"long",day:"numeric",month:"long"});
},1000);

update();
setInterval(update,600000);
</script>
</body>
</html>
