<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lobby Display - Amahot 11</title>
    <style>
        :root {
            --primary: #0f172a;
            --accent: #2563eb;
            --danger: #dc2626;
            --text: #f8fafc;
            --panel: rgba(30, 41, 59, 0.7);
        }

        body, html {
            margin: 0; padding: 0; height: 100vh; width: 100vw;
            font-family: 'Segoe UI', system-ui, -apple-system;
            background: #020617; color: var(--text); overflow: hidden;
        }

        /* Layout */
        .dashboard {
            display: grid;
            grid-template-columns: 350px 1fr 350px;
            grid-template-rows: 100px 1fr 60px;
            height: 100vh; gap: 15px; padding: 15px; box-sizing: border-box;
        }

        /* Header */

		header {
		  grid-column: 1 / -1;
		  background: var(--panel);
		  display: flex;
		  align-items: center;
		  padding: 0 30px;
		  border-radius: 15px;
		  border: 1px solid rgba(255,255,255,0.1);
		
		  justify-content: space-between;
		}

		
        .clock-area { text-align: right; display: flex; gap: 20px; align-items: center; }
        .time { font-size: 2.5rem; font-weight: 800; line-height: 1; }
        .date { font-size: 1.1rem; color: #94a3b8; }
        .weather { font-size: 1.5rem; color: #fbbf24; font-weight: bold; }

        /* Sidebar Containers */
        .sidebar {
            background: var(--panel); border-radius: 15px;
            display: flex; flex-direction: column; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-title {
            background: var(--accent); padding: 12px;
            text-align: center; font-weight: bold; font-size: 1.2rem;
        }

        .feed-container { flex: 1; overflow: hidden; position: relative; }

        /* Vertical Scrolling */
        .scroll-v { animation: scrollUp 50s linear infinite; padding: 15px; }
        @keyframes scrollUp { 0% { transform: translateY(0); } 100% { transform: translateY(-50%); } }

        .news-item { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }

        /* Center Content */
        .main-stage {
            position: relative; border-radius: 15px; overflow: hidden;
            background-size: cover; background-position: center;
            display: flex; align-items: flex-end;
        }

        .overlay-text {
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
            width: 100%; padding: 40px; box-sizing: border-box;
        }

        /* Bottom Ticker (FIXED DIRECTION & SPEED) */
        .footer-ticker {
            grid-column: 1 / -1; background: var(--danger);
            display: flex; align-items: center; border-radius: 10px; overflow: hidden;
            position: relative;
        }

        .ticker-label { background: #991b1b; padding: 0 20px; height: 100%; display: flex; align-items: center; z-index: 10; font-weight: bold; }
        
        .marquee-h {
            white-space: nowrap; 
            display: inline-block;
            font-size: 1.5rem;
            padding-right: 20px;
            /* ×©×™× ×•×™ ×”×× ×™××¦×™×” ××™××™×Ÿ ×œ×©×××œ ×•×‘××”×™×¨×•×ª ××™×˜×™×ª ×××•×“ */
            animation: scrollRightToLeft 250s linear infinite;
        }

		@keyframes scrollRightToLeft {
			0% { transform: translateX(-100%); }
			100% { transform: translateX(0%); } /* ×©×™× ×•×™ ×-100% ×œ-0% ×™×•×¦×¨ ×¨×¦×£ */
		}

        /* Settings */
        #settings { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 9999; padding: 40px; color: white; overflow-y: auto; }
        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        input, textarea { width: 100%; padding: 10px; background: #1e293b; border: 1px solid #334155; color: white; border-radius: 5px; }
        .gear { position: fixed; top: 10px; left: 10px; opacity: 0.2; cursor: pointer; z-index: 10000; font-size: 24px; }
    </style>
</head>
<body>

    <div class="gear" onclick="document.getElementById('settings').style.display='block'">âš™ï¸</div>

    <div id="settings">
        <h2>× ×™×”×•×œ ××¡×š ×œ×•×‘×™ - ×××”×•×ª 11</h2>
        <div class="settings-grid">
            <div>
                <label>×›×•×ª×¨×ª ×¨××©×™×ª:</label>
                <input type="text" id="s-title">
                <label>×œ×™× ×§ ×œ×ª××•× ×ª ×¨×§×¢:</label>
                <input type="text" id="s-bg">
                <label>×”×•×“×¢×•×ª ×•×¢×“ (××—×ª ×‘×›×œ ×©×•×¨×”):</label>
                <textarea id="s-comm" rows="10"></textarea>
            </div>
            <div>
                <label>RSS YNET:</label>
                <input type="text" id="s-ynet-url" value="https://www.ynet.co.il/Integration/StoryRss2.xml">
                <label>RSS ×•×•××œ×”:</label>
                <input type="text" id="s-walla-url" value="https://rss.view.nuvola.co.il/api/Rss/walla">
            </div>
        </div>
        <br>
        <button onclick="saveSettings()" style="background:var(--accent); color:white; padding:15px 40px; border:none; border-radius:5px; cursor:pointer;">×©××•×¨ ×•×¢×“×›×Ÿ</button>
        <button onclick="document.getElementById('settings').style.display='none'" style="background:#444; color:white; padding:15px 40px; border:none; border-radius:5px;">×‘×™×˜×•×œ</button>
    </div>

    <div class="dashboard">
		<header>
		  <h1 id="display-title" style="margin:0; font-size: 2.2rem;">
		    ×˜×•×¢×Ÿ...
		  </h1>
		
		  <div id="parasha" style="color:#fbbf24; font-size:1.4rem; font-weight:bold;"></div>
		
		  <div class="clock-area">
		    <div id="weather-info" class="weather">×˜×•×¢×Ÿ...</div>
		    <div>
		      <div class="time" id="clock-t">00:00</div>
		      <div class="date" id="clock-d">×˜×•×¢×Ÿ ×ª××¨×™×š...</div>
		    </div>
		  </div>
		</header>


        <div class="sidebar">
            <div class="sidebar-title">ğŸ“¢ ×”×•×“×¢×•×ª ×•×¢×“ ×”×‘×™×ª</div>
            <div class="feed-container">
                <div class="scroll-v" id="comm-list"></div>
            </div>
        </div>

        <div class="main-stage" id="display-bg">
            <div class="overlay-text">
                <h2 style="font-size: 3rem; margin: 0;">×××”×•×ª 11 - ××™×›×•×ª ×—×™×™×</h2>
            </div>
        </div>

        <div class="sidebar">
            <div class="sidebar-title">ğŸŒ ××‘×–×§×™ ×•×•××œ×”!</div>
            <div class="feed-container">
                <div class="scroll-v" id="walla-feed">×˜×•×¢×Ÿ...</div>
            </div>
        </div>

        <div class="footer-ticker">
            <div class="ticker-label">××‘×–×§×™ YNET</div>
            <div class="marquee-h" id="ynet-feed">×˜×•×¢×Ÿ ××‘×–×§×™× ×‘×–××Ÿ ×××ª...</div>
        </div>
    </div>

    <script>
		let config = JSON.parse(localStorage.getItem('ama11_cfg')) || {
		  title: "×××”×•×ª 11 - ×‘×¨×•×›×™× ×”×‘××™×",
		  bg: "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=1200",
		  comm: ["×©×“×¨×•×’ ×”××¢×œ×™×•×ª ×™×—×œ ×‘×§×¨×•×‘", "× × ×œ×©××•×¨ ×¢×œ ×”× ×™×§×™×•×Ÿ", "×ª×•×“×” ×œ×•×¢×“ ×”×‘×™×ª"],
		  ynetUrl: "https://rss.view.nuvola.co.il/api/Rss/ynet",
		  wallaUrl: "https://rss.view.nuvola.co.il/api/Rss/walla",
		  maarivUrl: "https://rss.view.nuvola.co.il/api/Rss/maariv"
		};


        async function fetchWeather() {
            try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=31.93&longitude=34.80&current_weather=true');
                const weather = await res.json();
                document.getElementById('weather-info').innerText = `â˜€ï¸ ${Math.round(weather.current_weather.temperature)}Â°C`;
            } catch (e) { console.log("Weather error"); }
        }

		async function fetchRSS(url, elementId, isHorizontal = false) {
		  const el = document.getElementById(elementId);
		
		  try {
		    const res = await fetch(url, { cache: "no-store" });
		    if (!res.ok) throw new Error("HTTP error");
		
		    const xmlText = await res.text();
		    const xml = new DOMParser().parseFromString(xmlText, "text/xml");
		    const items = xml.querySelectorAll("item");
		
		    let text = "";
		    let html = "";
		
		    items.forEach(item => {
		      const t = item.querySelector("title")?.textContent;
		      if (!t) return;
		      text += t + "  â€¢  ";
		      html += `<div class="news-item"><strong>${t}</strong></div>`;
		    });
		
		    if (isHorizontal) {
		      el.innerText = text + " " + text;
		    } else {
		      el.innerHTML = html;
		    }
		
		  } catch (e) {
		    // ×× ×–×” × ×›×©×œ - ×©×•××¨×™× ××ª ××” ×©×”×™×”, ×œ× ××¦×™×’×™× ×©×’×™××”
		    console.warn("RSS failed:", url);
		  }
		}


        function updateDisplay() {
            document.getElementById('display-title').innerText = config.title;
            document.getElementById('display-bg').style.backgroundImage = `url('${config.bg}')`;
            document.getElementById('comm-list').innerHTML = config.comm.map(i => `<div class="news-item">${i}</div>`).join('');

			fetchRSS(config.wallaUrl, 'walla-feed', false);
			fetchRSS(config.ynetUrl, 'ynet-feed', true);

            fetchWeather();
            
            const day = new Date().getDay();
            document.getElementById('parasha').innerText = (day >= 5) ? "×¤×¨×©×ª ×”×©×‘×•×¢: ×™×ª×¨×•" : "";
        }

        function saveSettings() {
            config.title = document.getElementById('s-title').value;
            config.bg = document.getElementById('s-bg').value;
            config.comm = document.getElementById('s-comm').value.split('\n');
            localStorage.setItem('ama11_cfg', JSON.stringify(config));
            location.reload();
        }

        setInterval(() => {
            const now = new Date();
            document.getElementById('clock-t').innerText = now.toLocaleTimeString('he-IL', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('clock-d').innerText = now.toLocaleDateString('he-IL', {weekday: 'long', day: 'numeric', month: 'long'});
        }, 1000);

        document.getElementById('s-title').value = config.title;
        document.getElementById('s-bg').value = config.bg;
        document.getElementById('s-comm').value = config.comm.join('\n');

        updateDisplay();
        setInterval(updateDisplay, 600000); // ×¨×¢× ×•×Ÿ ×›×œ 10 ×“×§'
    </script>
</body>
</html>
